# Source: https://github.com/Hats-Protocol/subgraph

[Hats-Protocol](https://github.com/Hats-Protocol)/ **[subgraph](https://github.com/Hats-Protocol/subgraph)** Public

- [Notifications](https://github.com/login?return_to=%2FHats-Protocol%2Fsubgraph) You must be signed in to change notification settings
- [Fork\\
2](https://github.com/login?return_to=%2FHats-Protocol%2Fsubgraph)
- [Star\\
4](https://github.com/login?return_to=%2FHats-Protocol%2Fsubgraph)


[4\\
stars](https://github.com/Hats-Protocol/subgraph/stargazers) [2\\
forks](https://github.com/Hats-Protocol/subgraph/forks) [Branches](https://github.com/Hats-Protocol/subgraph/branches) [Tags](https://github.com/Hats-Protocol/subgraph/tags) [Activity](https://github.com/Hats-Protocol/subgraph/activity)

[Star](https://github.com/login?return_to=%2FHats-Protocol%2Fsubgraph)

[Notifications](https://github.com/login?return_to=%2FHats-Protocol%2Fsubgraph) You must be signed in to change notification settings

# Hats-Protocol/subgraph

main

[**6** Branches](https://github.com/Hats-Protocol/subgraph/branches) [**0** Tags](https://github.com/Hats-Protocol/subgraph/tags)

[Go to Branches page](https://github.com/Hats-Protocol/subgraph/branches)[Go to Tags page](https://github.com/Hats-Protocol/subgraph/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![scottrepreneur](https://avatars.githubusercontent.com/u/1778380?v=4&size=40)](https://github.com/scottrepreneur)[scottrepreneur](https://github.com/Hats-Protocol/subgraph/commits?author=scottrepreneur)<br>[add base sepolia](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453)<br>Mar 29, 2025<br>[7441d8f](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453) · Mar 29, 2025<br>## History<br>[54 Commits](https://github.com/Hats-Protocol/subgraph/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/Hats-Protocol/subgraph/commits/main/) |
| [abis](https://github.com/Hats-Protocol/subgraph/tree/main/abis "abis") | [abis](https://github.com/Hats-Protocol/subgraph/tree/main/abis "abis") | [modules factory v0.7.0](https://github.com/Hats-Protocol/subgraph/commit/62bb0f391860d13ff4539cfcfce66ed0b6e652d9 "modules factory v0.7.0") | Mar 19, 2024 |
| [src](https://github.com/Hats-Protocol/subgraph/tree/main/src "src") | [src](https://github.com/Hats-Protocol/subgraph/tree/main/src "src") | [modules factory v0.7.0](https://github.com/Hats-Protocol/subgraph/commit/62bb0f391860d13ff4539cfcfce66ed0b6e652d9 "modules factory v0.7.0") | Mar 19, 2024 |
| [tests](https://github.com/Hats-Protocol/subgraph/tree/main/tests "tests") | [tests](https://github.com/Hats-Protocol/subgraph/tree/main/tests "tests") | [modules factory v0.7.0](https://github.com/Hats-Protocol/subgraph/commit/62bb0f391860d13ff4539cfcfce66ed0b6e652d9 "modules factory v0.7.0") | Mar 19, 2024 |
| [.gitignore](https://github.com/Hats-Protocol/subgraph/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/Hats-Protocol/subgraph/blob/main/.gitignore ".gitignore") | [add base sepolia](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453 "add base sepolia") | Mar 29, 2025 |
| [README.md](https://github.com/Hats-Protocol/subgraph/blob/main/README.md "README.md") | [README.md](https://github.com/Hats-Protocol/subgraph/blob/main/README.md "README.md") | [add base sepolia](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453 "add base sepolia") | Mar 29, 2025 |
| [funding.json](https://github.com/Hats-Protocol/subgraph/blob/main/funding.json "funding.json") | [funding.json](https://github.com/Hats-Protocol/subgraph/blob/main/funding.json "funding.json") | [Create funding.json](https://github.com/Hats-Protocol/subgraph/commit/24e48d239d754e0996b66f31c45b36e15f155fd2 "Create funding.json") | May 29, 2024 |
| [networks.json](https://github.com/Hats-Protocol/subgraph/blob/main/networks.json "networks.json") | [networks.json](https://github.com/Hats-Protocol/subgraph/blob/main/networks.json "networks.json") | [add base sepolia](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453 "add base sepolia") | Mar 29, 2025 |
| [package.json](https://github.com/Hats-Protocol/subgraph/blob/main/package.json "package.json") | [package.json](https://github.com/Hats-Protocol/subgraph/blob/main/package.json "package.json") | [add base sepolia](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453 "add base sepolia") | Mar 29, 2025 |
| [pnpm-lock.yaml](https://github.com/Hats-Protocol/subgraph/blob/main/pnpm-lock.yaml "pnpm-lock.yaml") | [pnpm-lock.yaml](https://github.com/Hats-Protocol/subgraph/blob/main/pnpm-lock.yaml "pnpm-lock.yaml") | [add base sepolia](https://github.com/Hats-Protocol/subgraph/commit/7441d8fdc7e64576a2066bea57c29978a307f453 "add base sepolia") | Mar 29, 2025 |
| [schema.graphql](https://github.com/Hats-Protocol/subgraph/blob/main/schema.graphql "schema.graphql") | [schema.graphql](https://github.com/Hats-Protocol/subgraph/blob/main/schema.graphql "schema.graphql") | [wip](https://github.com/Hats-Protocol/subgraph/commit/69a1c5eb79ee9d8c6018fdd323064dc24c870256 "wip") | Sep 28, 2023 |
| [subgraph.yaml](https://github.com/Hats-Protocol/subgraph/blob/main/subgraph.yaml "subgraph.yaml") | [subgraph.yaml](https://github.com/Hats-Protocol/subgraph/blob/main/subgraph.yaml "subgraph.yaml") | [modules factory v0.7.0](https://github.com/Hats-Protocol/subgraph/commit/62bb0f391860d13ff4539cfcfce66ed0b6e652d9 "modules factory v0.7.0") | Mar 19, 2024 |
| [tsconfig.json](https://github.com/Hats-Protocol/subgraph/blob/main/tsconfig.json "tsconfig.json") | [tsconfig.json](https://github.com/Hats-Protocol/subgraph/blob/main/tsconfig.json "tsconfig.json") | [Initial commit](https://github.com/Hats-Protocol/subgraph/commit/20cefc0ed84b88f3c503777b7a68394c534b1610 "Initial commit") | Jul 17, 2022 |
| View all files |

## Repository files navigation

# Hats-Protocol Subgraph

[Permalink: Hats-Protocol Subgraph](https://github.com/Hats-Protocol/subgraph#hats-protocol-subgraph)

This is a subgraph for the [Hats-Protocol](https://www.hatsprotocol.xyz/) project.

# Important Note:

[Permalink: Important Note:](https://github.com/Hats-Protocol/subgraph#important-note)

The `status` and `badStandings` fields of a `Hat` entity, track the status and standing as currently recorded in the Hats contract. It is NOT tracking the eligibility and toggle modules in case they exist and thus only represent the last recorded state in the Hats contract. In case they depend on the state of external contracts, these fields in the subgraph may be out of sync with the onchain state.

# Example Queries

[Permalink: Example Queries](https://github.com/Hats-Protocol/subgraph#example-queries)

## Tree

[Permalink: Tree](https://github.com/Hats-Protocol/subgraph#tree)

Every hat belongs to a tree, which root is a top hat. The ID of a tree, is it's top hat domain (first 4 bytes of the top hat ID).
The following query will get all existing trees, and the hats that exist in each tree:

```
{
  trees {
    id
    hats {
      id
    }
  }
}
```

Get a specific tree:

```
{
  tree(id: "0x00000001") {
    id
    hats {
      id
    }
  }
}
```

In case the tree was linked to another tree, get the parent tree:

```
{
  tree(id: "0x00000001") {
    id
    childOfTree {
      id
    }
  }
}
```

In case the tree was linked to another tree, get the hat that the tree is linked to:

```
{
  tree(id: "0x00000001") {
    id
    linkedToHat {
      id
    }
  }
}
```

In case the tree was linked to by other trees, get the trees that are linked directly to the tree:

```
{
  tree(id: "0x00000001") {
    id
    parentOfTrees {
      id
    }
  }
}
```

## Hat

[Permalink: Hat](https://github.com/Hats-Protocol/subgraph#hat)

The ID of the hat entity is the ID of the hat in hex format.

Additionally, the hat entity includes a "prettyId" field, which is formatted in an IP address style:

- In hex, with the `0x` prefix
- Periods between the hat levels
- Only levels with non-zero values are shown
For example, the "prettyId" of a level 3 hat might look like this: `0x00000001.0001.0001`

The following query will get all the basic information of a hat:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    prettyId
    status
    details
    eligibility
    toggle
    mutable
    imageUri
    createdAt
    maxSupply
    currentSupply
    levelAtLocalTree
  }
}
```

The following query will get the tree that the hat belongs to:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    tree {
      id
    }
  }
}
```

The following query will get the admin of the hat:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    admin {
      id
    }
  }
}
```

The following query will get the sub-hats that are one level deeper:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    subHats {
      id
    }
  }
}
```

The following query will get the wearers of the hat:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    wearers {
      id
    }
  }
}
```

The following query will get the all the wearers with a bad standing:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    badStandings {
      id
    }
  }
}
```

The following query will get the all the trees that are linked to a hat:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    linkedTrees {
      id
    }
  }
}
```

## Wearer

[Permalink: Wearer](https://github.com/Hats-Protocol/subgraph#wearer)

The ID of the wearer is its address.

The following query will get all hats of a wearer:

```
{
  wearer(id: "0xabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd") {
    id
    currentHats {
      id
    }
  }
}
```

## Events

[Permalink: Events](https://github.com/Hats-Protocol/subgraph#events)

The events are used to track the history of hats and wearers.
The event ID format is `<event name>-<block number>-<log index>`.

The following query will get the entire history of events in a specific tree:

```
{
  tree(id: "0x00000001") {
    id
    events {
      id
      blockNumber
      timestamp
      transactionID
      tree {
        id
      }
      hat {
        id
      }
      ... on HatCreatedEvent {
        hatDetails
        hatMaxSupply
        hatEligibility
        hatToggle
        hatMutable
        hatImageUri
      }
      ... on HatMintedEvent {
        wearer {
          id
        }
        operator
      }
      ... on HatBurnedEvent {
        wearer {
          id
        }
        operator
      }
      ... on HatStatusChangedEvent {
        hatNewStatus
      }
      ... on HatDetailsChangedEvent {
        hatNewDetails
      }
      ... on HatEligibilityChangedEvent {
        hatNewEligibility
      }
      ... on HatToggleChangedEvent {
        hatNewToggle
      }
      ... on HatMutabilityChangedEvent {
      }
      ... on HatMaxSupplyChangedEvent {
        hatNewMaxSupply
      }
      ... on HatImageURIChangedEvent {
        hatNewImageURI
      }
      ... on TopHatLinkRequestedEvent {
        newAdmin
      }
      ... on TopHatLinkedEvent {
        newAdmin
      }
      ... on WearerStandingChangedEvent {
        wearer {
          id
        }
        wearerStanding
      }
    }
  }
}
```

The following query will get the entire history of events in a specific hat:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    id
    events {
      id
      blockNumber
      timestamp
      transactionID
      ... on HatCreatedEvent {
        hatId
      }
      ... on HatMintedEvent {
        hatId
        wearer {
          id
        }
        operator
      }
      ... on HatBurnedEvent {
        hatId
        wearer {
          id
        }
        operator
      }
      ... on HatStatusChangedEvent {
        hatId
        hatNewStatus
      }
      ... on HatDetailsChangedEvent {
        hatId
        hatNewDetails
      }
      ... on HatEligibilityChangedEvent {
        hatId
        hatNewEligibility
      }
      ... on HatToggleChangedEvent {
        hatId
        hatNewToggle
      }
      ... on HatMutabilityChangedEvent {
        hatId
      }
      ... on HatMaxSupplyChangedEvent {
        hatId
        hatNewMaxSupply
      }
      ... on HatImageURIChangedEvent {
        hatId
        hatNewImageURI
      }
      ... on TopHatLinkRequestedEvent {
        newAdmin
      }
      ... on TopHatLinkedEvent {
        newAdmin
      }
      ... on WearerStandingChangedEvent {
        wearer {
          id
        }
        wearerStanding
      }
    }
  }
}
```

The following query will get the history of hat mint and burn events for a specific wearer:

```
{
  wearer(id: "0xabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd") {
    id
    mintEvent {
      id
      hatId
      wearer {
        id
      }
      operator
    }
    burnEvent {
      id
      hatId
      wearer {
        id
      }
      operator
    }
  }
}
```

## Misc

[Permalink: Misc](https://github.com/Hats-Protocol/subgraph#misc)

The following query will get the siblings of a hat:

```
{
  hat(
    id: "0x0000000100010000000000000000000000000000000000000000000000000000"
  ) {
    admin {
      subHats {
        id
      }
    }
  }
}
```

The following query will get a sub tree, in which a specific hat is a root of:

```
{
  hats(
    where: {
      id_gte: "0x0000000100010000000000000000000000000000000000000000000000000000"
      id_lt: "0x0000000100020000000000000000000000000000000000000000000000000000"
    }
  ) {
    id
  }
}
```

### Publishing

[Permalink: Publishing](https://github.com/Hats-Protocol/subgraph#publishing)

To publish the subgraph, run the following command:

```
graph publish --node https://api.studio.thegraph.com/deploy/ hats-protocol/hats-v1-mainnet
```

## About

No description, website, or topics provided.


### Resources

[Readme](https://github.com/Hats-Protocol/subgraph#readme-ov-file)

[Activity](https://github.com/Hats-Protocol/subgraph/activity)

[Custom properties](https://github.com/Hats-Protocol/subgraph/custom-properties)

### Stars

[**4**\\
stars](https://github.com/Hats-Protocol/subgraph/stargazers)

### Watchers

[**2**\\
watching](https://github.com/Hats-Protocol/subgraph/watchers)

### Forks

[**2**\\
forks](https://github.com/Hats-Protocol/subgraph/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FHats-Protocol%2Fsubgraph&report=Hats-Protocol+%28user%29)

## [Releases](https://github.com/Hats-Protocol/subgraph/releases)

No releases published

## [Packages](https://github.com/orgs/Hats-Protocol/packages?repo_name=subgraph)

No packages published

## [Contributors\  4](https://github.com/Hats-Protocol/subgraph/graphs/contributors)

- [![@gershido](https://avatars.githubusercontent.com/u/81111572?s=64&v=4)](https://github.com/gershido)[**gershido**](https://github.com/gershido)
- [![@jordanlesich](https://avatars.githubusercontent.com/u/53406838?s=64&v=4)](https://github.com/jordanlesich)[**jordanlesich** Jord](https://github.com/jordanlesich)
- [![@spengrah](https://avatars.githubusercontent.com/u/13247381?s=64&v=4)](https://github.com/spengrah)[**spengrah** Spencer Graham](https://github.com/spengrah)
- [![@scottrepreneur](https://avatars.githubusercontent.com/u/1778380?s=64&v=4)](https://github.com/scottrepreneur)[**scottrepreneur**](https://github.com/scottrepreneur)

## Languages

- [TypeScript100.0%](https://github.com/Hats-Protocol/subgraph/search?l=typescript)
