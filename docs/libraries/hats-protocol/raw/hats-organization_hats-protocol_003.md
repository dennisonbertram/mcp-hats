# Source: https://github.com/Hats-Protocol/hats-protocol

[Hats-Protocol](https://github.com/Hats-Protocol)/ **[hats-protocol](https://github.com/Hats-Protocol/hats-protocol)** Public

- [Notifications](https://github.com/login?return_to=%2FHats-Protocol%2Fhats-protocol) You must be signed in to change notification settings
- [Fork\\
27](https://github.com/login?return_to=%2FHats-Protocol%2Fhats-protocol)
- [Star\\
92](https://github.com/login?return_to=%2FHats-Protocol%2Fhats-protocol)


Core contracts for Hats Protocol v1


[www.hatsprotocol.xyz](https://www.hatsprotocol.xyz/ "https://www.hatsprotocol.xyz")

### License

[AGPL-3.0 license](https://github.com/Hats-Protocol/hats-protocol/blob/main/LICENSE)

[92\\
stars](https://github.com/Hats-Protocol/hats-protocol/stargazers) [27\\
forks](https://github.com/Hats-Protocol/hats-protocol/forks) [Branches](https://github.com/Hats-Protocol/hats-protocol/branches) [Tags](https://github.com/Hats-Protocol/hats-protocol/tags) [Activity](https://github.com/Hats-Protocol/hats-protocol/activity)

[Star](https://github.com/login?return_to=%2FHats-Protocol%2Fhats-protocol)

[Notifications](https://github.com/login?return_to=%2FHats-Protocol%2Fhats-protocol) You must be signed in to change notification settings

# Hats-Protocol/hats-protocol

main

[**8** Branches](https://github.com/Hats-Protocol/hats-protocol/branches) [**5** Tags](https://github.com/Hats-Protocol/hats-protocol/tags)

[Go to Branches page](https://github.com/Hats-Protocol/hats-protocol/branches)[Go to Tags page](https://github.com/Hats-Protocol/hats-protocol/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![spengrah](https://avatars.githubusercontent.com/u/13247381?v=4&size=40)](https://github.com/spengrah)[spengrah](https://github.com/Hats-Protocol/hats-protocol/commits?author=spengrah)<br>[Merge pull request](https://github.com/Hats-Protocol/hats-protocol/commit/cccb71a061cdb9095af7d11dfdb47026993d8c4e) [#133](https://github.com/Hats-Protocol/hats-protocol/pull/133) [from Hats-Protocol/funding-json-patch](https://github.com/Hats-Protocol/hats-protocol/commit/cccb71a061cdb9095af7d11dfdb47026993d8c4e)<br>Open commit details<br>May 29, 2024<br>[cccb71a](https://github.com/Hats-Protocol/hats-protocol/commit/cccb71a061cdb9095af7d11dfdb47026993d8c4e) · May 29, 2024<br>## History<br>[413 Commits](https://github.com/Hats-Protocol/hats-protocol/commits/main/) <br>Open commit details<br>[View commit history for this file.](https://github.com/Hats-Protocol/hats-protocol/commits/main/) |
| [.github/workflows](https://github.com/Hats-Protocol/hats-protocol/tree/main/.github/workflows "This path skips through empty directories") | [.github/workflows](https://github.com/Hats-Protocol/hats-protocol/tree/main/.github/workflows "This path skips through empty directories") | [add deploy workflow for docs](https://github.com/Hats-Protocol/hats-protocol/commit/b9557991991e9af5748148dc198d111e59d49872 "add deploy workflow for docs") | Jan 20, 2023 |
| [audits](https://github.com/Hats-Protocol/hats-protocol/tree/main/audits "audits") | [audits](https://github.com/Hats-Protocol/hats-protocol/tree/main/audits "audits") | [add sherlock audit doc](https://github.com/Hats-Protocol/hats-protocol/commit/4d46ff59b1844534e980b014af56ee9b22dd43ef "add sherlock audit doc") | May 4, 2023 |
| [lib](https://github.com/Hats-Protocol/hats-protocol/tree/main/lib "lib") | [lib](https://github.com/Hats-Protocol/hats-protocol/tree/main/lib "lib") | [fix solady submodule](https://github.com/Hats-Protocol/hats-protocol/commit/3ad18500ab1964160fe8814cca463a781010b938 "fix solady submodule") | Jul 9, 2023 |
| [script](https://github.com/Hats-Protocol/hats-protocol/tree/main/script "script") | [script](https://github.com/Hats-Protocol/hats-protocol/tree/main/script "script") | [deploy to goerli](https://github.com/Hats-Protocol/hats-protocol/commit/ca1a30ee683eb379f7edfb7389b70751d53893be "deploy to goerli") | Jul 9, 2023 |
| [src](https://github.com/Hats-Protocol/hats-protocol/tree/main/src "src") | [src](https://github.com/Hats-Protocol/hats-protocol/tree/main/src "src") | [add version notice](https://github.com/Hats-Protocol/hats-protocol/commit/b23340f825a2cdf9f5758462f8161d7076ad7f6f "add version notice") | Jul 9, 2023 |
| [test](https://github.com/Hats-Protocol/hats-protocol/tree/main/test "test") | [test](https://github.com/Hats-Protocol/hats-protocol/tree/main/test "test") | [multicallable](https://github.com/Hats-Protocol/hats-protocol/commit/9353387cd739da442853826b5f1b4854d6ab1b49 "multicallable") | Jun 30, 2023 |
| [.gas-snapshot](https://github.com/Hats-Protocol/hats-protocol/blob/main/.gas-snapshot ".gas-snapshot") | [.gas-snapshot](https://github.com/Hats-Protocol/hats-protocol/blob/main/.gas-snapshot ".gas-snapshot") | [named return variables and interface cleanup](https://github.com/Hats-Protocol/hats-protocol/commit/949ddb13324b748913907c2552a8252eb45b9c44 "named return variables and interface cleanup") | Feb 23, 2023 |
| [.gitignore](https://github.com/Hats-Protocol/hats-protocol/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/Hats-Protocol/hats-protocol/blob/main/.gitignore ".gitignore") | [gitignore broadcast (deploys viewable in Releases)](https://github.com/Hats-Protocol/hats-protocol/commit/994c3c2d9849c524726f8866d6e3e4f0b622c3c7 "gitignore broadcast (deploys viewable in Releases)") | Jan 24, 2023 |
| [.gitmodules](https://github.com/Hats-Protocol/hats-protocol/blob/main/.gitmodules ".gitmodules") | [.gitmodules](https://github.com/Hats-Protocol/hats-protocol/blob/main/.gitmodules ".gitmodules") | [multicallable](https://github.com/Hats-Protocol/hats-protocol/commit/9353387cd739da442853826b5f1b4854d6ab1b49 "multicallable") | Jun 30, 2023 |
| [.markdownlintrc](https://github.com/Hats-Protocol/hats-protocol/blob/main/.markdownlintrc ".markdownlintrc") | [.markdownlintrc](https://github.com/Hats-Protocol/hats-protocol/blob/main/.markdownlintrc ".markdownlintrc") | [again try fix linting action](https://github.com/Hats-Protocol/hats-protocol/commit/9738f2a8988f1a362348e35ec29e0630f8c3e714 "again try fix linting action") | Jul 25, 2022 |
| [CONTRIBUTING.md](https://github.com/Hats-Protocol/hats-protocol/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") | [CONTRIBUTING.md](https://github.com/Hats-Protocol/hats-protocol/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") | [add deploy workflow for docs](https://github.com/Hats-Protocol/hats-protocol/commit/b9557991991e9af5748148dc198d111e59d49872 "add deploy workflow for docs") | Jan 20, 2023 |
| [LICENSE](https://github.com/Hats-Protocol/hats-protocol/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/Hats-Protocol/hats-protocol/blob/main/LICENSE "LICENSE") | [AGPL v3](https://github.com/Hats-Protocol/hats-protocol/commit/141cbe929db451919d729f66e299c79977c2326f "AGPL v3") | Nov 30, 2022 |
| [README.md](https://github.com/Hats-Protocol/hats-protocol/blob/main/README.md "README.md") | [README.md](https://github.com/Hats-Protocol/hats-protocol/blob/main/README.md "README.md") | [update README](https://github.com/Hats-Protocol/hats-protocol/commit/b43ad0d1dbe4a4190febc036ee8a2849e3f221b4 "update README") | Jul 9, 2023 |
| [book.toml](https://github.com/Hats-Protocol/hats-protocol/blob/main/book.toml "book.toml") | [book.toml](https://github.com/Hats-Protocol/hats-protocol/blob/main/book.toml "book.toml") | [additional config for auto-generated docs](https://github.com/Hats-Protocol/hats-protocol/commit/1fc0e04053c8b59236d45cb43903f92fe5aa33a6 "additional config for auto-generated docs") | Jan 21, 2023 |
| [example.env](https://github.com/Hats-Protocol/hats-protocol/blob/main/example.env "example.env") | [example.env](https://github.com/Hats-Protocol/hats-protocol/blob/main/example.env "example.env") | [deploy v1](https://github.com/Hats-Protocol/hats-protocol/commit/c297e51bd7137490d28d91370e050bce202843d4 "deploy v1") | Mar 20, 2023 |
| [foundry.toml](https://github.com/Hats-Protocol/hats-protocol/blob/main/foundry.toml "foundry.toml") | [foundry.toml](https://github.com/Hats-Protocol/hats-protocol/blob/main/foundry.toml "foundry.toml") | [multicallable](https://github.com/Hats-Protocol/hats-protocol/commit/9353387cd739da442853826b5f1b4854d6ab1b49 "multicallable") | Jun 30, 2023 |
| [funding.json](https://github.com/Hats-Protocol/hats-protocol/blob/main/funding.json "funding.json") | [funding.json](https://github.com/Hats-Protocol/hats-protocol/blob/main/funding.json "funding.json") | [Update funding.json](https://github.com/Hats-Protocol/hats-protocol/commit/65823899493ff9354113b23015aeacb4f6336420 "Update funding.json  Update for Retro Funding round 4 production (the previous version was for the their test environment)") | May 29, 2024 |
| [lcov.info](https://github.com/Hats-Protocol/hats-protocol/blob/main/lcov.info "lcov.info") | [lcov.info](https://github.com/Hats-Protocol/hats-protocol/blob/main/lcov.info "lcov.info") | [update snapshot and coverage trackers](https://github.com/Hats-Protocol/hats-protocol/commit/161142af03210cd0fee2b048a942802b11952748 "update snapshot and coverage trackers") | Jan 21, 2023 |
| [remappings.txt](https://github.com/Hats-Protocol/hats-protocol/blob/main/remappings.txt "remappings.txt") | [remappings.txt](https://github.com/Hats-Protocol/hats-protocol/blob/main/remappings.txt "remappings.txt") | [add remappings.txt](https://github.com/Hats-Protocol/hats-protocol/commit/6d74d231320894fd09623be536639db7dfd67e61 "add remappings.txt") | Jul 9, 2023 |
| View all files |

## Repository files navigation

[Permalink: ](https://github.com/Hats-Protocol/hats-protocol#)

[![Contributors](https://camo.githubusercontent.com/b33166daf87c7072fb370262ff882fa84d71d87f3d92a6b1dd7e70a0789693e7/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f486174732d50726f746f636f6c2f686174732d70726f746f636f6c2e7376673f7374796c653d666c6174)](https://github.com/Hats-Protocol/hats-protocol/graphs/contributors)[![Stargazers](https://camo.githubusercontent.com/b93b94a4c9522123de877e7195cf744712ae4edc264c9fd9c5343ba28eaa5ab8/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f486174732d50726f746f636f6c2f686174732d70726f746f636f6c2e7376673f7374796c653d666c6174)](https://github.com/Hats-Protocol/hats-protocol/stargazers)[![Issues](https://camo.githubusercontent.com/a93713c886ded754c5e2a059e1f2860fd856679fc48fbfd13314460927662bb0/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732f486174732d50726f746f636f6c2f686174732d70726f746f636f6c2e7376673f7374796c653d666c6174)](https://github.com/Hats-Protocol/hats-protocol/issues)[![Twitter](https://camo.githubusercontent.com/39b2ee4a5627c4d39977c005b44cb249de833c4331b01e97e1852148580411a9/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f75726c3f6c6162656c3d2534304861747350726f746f636f6c267374796c653d736f6369616c2675726c3d6874747073253341253246253246747769747465722e636f6d2532464861747350726f746f636f6c)](https://twitter.com/hatsprotocol)

[![Hats Hat](https://camo.githubusercontent.com/95eaa609fd06f6a66ffbc844eeec62c2b85c017bbf6e069f3bb8c9a22c6b0b40/68747470733a2f2f697066732e696f2f697066732f516d625179347673753461414875517770486f4855734555527469594b45626876376f75756d4258696965727039)](https://github.com/Hats-Protocol/hats-protocol)

## Hats Protocol

[Permalink: Hats Protocol](https://github.com/Hats-Protocol/hats-protocol#hats-protocol)

How DAOs get things done


[Hats Protocol Website](https://hatsprotocol.xyz/)
·
[Report Bug](https://github.com/Hats-Protocol/hats-protocol/issues)
·
[Request Feature](https://github.com/Hats-Protocol/hats-protocol/issues)

Table of Contents

1. [About The Project](https://github.com/Hats-Protocol/hats-protocol#about-the-project)   - [Deployments](https://github.com/Hats-Protocol/hats-protocol#latest-deployments)
   - [Security Audits](https://github.com/Hats-Protocol/hats-protocol#security-audits)
2. [Contributing](https://github.com/Hats-Protocol/hats-protocol#contributing)
3. [Hats Protocol Docs](https://github.com/Hats-Protocol/hats-protocol#hats-protocol-docs)
4. [License](https://github.com/Hats-Protocol/hats-protocol#license)
5. [Contact](https://github.com/Hats-Protocol/hats-protocol#contact)

## About The Project

[Permalink: About The Project](https://github.com/Hats-Protocol/hats-protocol#about-the-project)

Hats Protocol is a protocol for DAO-native roles and credentials that supports revocable delegation of authority and responsibility.

Hats are represented on-chain by non-transferable tokens that conform to the ERC1155 interface. An address with a balance of a given Hat token "wears" that hat, granting them the responsibilities and authorities that have been assigned to the Hat by the DAO.

### Deployments

[Permalink: Deployments](https://github.com/Hats-Protocol/hats-protocol#deployments)

For information on Hats Protocol versions and deployments, see [Releases](https://github.com/Hats-Protocol/hats-protocol/releases).

### Security Audits

[Permalink: Security Audits](https://github.com/Hats-Protocol/hats-protocol#security-audits)

This project has received two security audits, listed below. See the [audits](https://github.com/Hats-Protocol/hats-protocol/tree/main/audits) directory for the detailed reports.

| Auditor | Report Date | Review Commit Hash | Notes |
| --- | --- | --- | --- |
| Trust Security | Feb 23, 2023 | [60f07df](https://github.com/Hats-Protocol/hats-protocol/commit/60f07df0679ba52d4ad818b1bb3700d2f4f5a63a) | Report also includes findings from [Hats Protocol](https://github.com/Hats-Protocol/hats-protocol) audit |
| Sherlock | May 3, 2023 | [fafcfd](https://github.com/Hats-Protocol/hats-protocol/commit/fafcfdf046c0369c1f9e077eacd94a328f9d7af0) | Report also includes findings from [Hats Protocol](https://github.com/Hats-Protocol/hats-protocol) audit |

## Contributing

[Permalink: Contributing](https://github.com/Hats-Protocol/hats-protocol#contributing)

See [CONTRIBUTING.md](https://github.com/Hats-Protocol/hats-protocol/blob/main/CONTRIBUTING.md) for details on how to contribute.

( [back to top](https://github.com/Hats-Protocol/hats-protocol#readme-top))

## Hats Protocol Docs

[Permalink: Hats Protocol Docs](https://github.com/Hats-Protocol/hats-protocol#hats-protocol-docs)

### Table of Contents

[Permalink: Table of Contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents)

01. [Authorities in Hats Protocol](https://github.com/Hats-Protocol/hats-protocol#authorities-in-hats-protocol)
02. [Hats Logic](https://github.com/Hats-Protocol/hats-protocol#hats-logic)
03. [ERC1155 Compatibility](https://github.com/Hats-Protocol/hats-protocol#erc1155-compatibility)
04. [Wearing a Hat](https://github.com/Hats-Protocol/hats-protocol#wearing-a-hat)
05. [Hat Admins](https://github.com/Hats-Protocol/hats-protocol#hat-admins)
06. [Addressable Hat Ids](https://github.com/Hats-Protocol/hats-protocol#addressable-hat-ids)
07. [Eligibility](https://github.com/Hats-Protocol/hats-protocol#eligibility)
08. [Toggle](https://github.com/Hats-Protocol/hats-protocol#toggle)
09. [Hat Mutability](https://github.com/Hats-Protocol/hats-protocol#hat-mutability)
10. [Hat Image URIs](https://github.com/Hats-Protocol/hats-protocol#hat-image-uris)
11. [Creating a Hat](https://github.com/Hats-Protocol/hats-protocol#creating-a-hat)
12. [Minting a Hat](https://github.com/Hats-Protocol/hats-protocol#minting-a-hat)
13. [Transferring a Hat](https://github.com/Hats-Protocol/hats-protocol#transferring-a-hat)
14. [Hat Tree Grafting](https://github.com/Hats-Protocol/hats-protocol#hat-tree-grafting)
15. [Renouncing a Hat](https://github.com/Hats-Protocol/hats-protocol#renouncing-a-hat)

### Authorities in Hats Protocol

[Permalink: Authorities in Hats Protocol](https://github.com/Hats-Protocol/hats-protocol#authorities-in-hats-protocol)

One way to think about a Hat is as a primitive that creates a substrate onto which a DAO can attach authorities (e.g., access rights) and responsibilities via other tools (e.g., token-gating platforms).

Hats Protocol itself does not define mechanisms for how such authorities and responsibilities are associated with a Hat. All such associations are created external to the protocol.

Here are a few examples of how a DAO might confer authorities and responsibilities to a Hat:

| Authority | How is it attached to the Hat? |
| --- | --- |
| Signer on a multisig | Using the Hat's ERC1155-similar token as a condition for membership in a Metropolis Pod |
| Admin of the DAO's Github repo | Using the Hat's ERC1155-similar token as a condition for access via Lit Protocol |
| Leadership of a working group | A social expectation |

In each case, the DAO uses a separate tool to attach the authority to the Hat.

Hats is designed to be highly composable -- it will work with any tool, application, or protocol that can interact with the ERC1155 interface. Further, it allows any number of such authorities or responsibilities to be attached to a single Hat, which greatly simplifies the process for DAOs of revoking those authorities as well as the process of role handoff.

#### Exception: Hat Admins

[Permalink: Exception: Hat Admins](https://github.com/Hats-Protocol/hats-protocol#exception-hat-admins)

Hat admins are the one (very important!) exception to the rule that authorities are external to the Hats Protocol. Refer to the Admins section below for more details.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### ERC1155 Compatibility

[Permalink: ERC1155 Compatibility](https://github.com/Hats-Protocol/hats-protocol#erc1155-compatibility)

Hats Protocol conforms fully to the ERC1155 interface. All external functions required by the [ERC1155 standard](https://eips.ethereum.org/EIPS/eip-1155) are exposed by Hats Protocol. This is how Hats can work out of the box with existing token-gating applications.

However, Hats Protocol is not fully compliant with the ERC1155 standard. Since Hats are not transferable by their owners (aka "wearers"), there is little need for safe transfers and the `ERC1155TokenReceiver` logic. Developers building on top of Hats Protocol should note that mints and transfers of Hats will not, for example, include calls to `onERC1155Received`.

To avoid confusion, Hats Protocol does not claim to be ERC1155-compliant. Instead, we say that Hats Protocol has "ERC1155-similar" tokens. When referring specifically to the ERC1155 interface, however, we do say that Hats Protocol conforms fully.

### Hats Logic

[Permalink: Hats Logic](https://github.com/Hats-Protocol/hats-protocol#hats-logic)

Each Hat has several properties:

- `id` \- the integer identifier for the Hat, which also serves as the ERC1155-similar token id (see three paragraphs below)
- `details` \- metadata about the Hat; such as a name, description, and other properties like roles and responsibilities associated with the Hat. Should not exceed 7,000 characters.
- `maxSupply` \- the maximum number of addresses that can wear the Hat at once
- `admin` \- the Hat that controls who can wear the Hat
- `eligibility` \- the address that controls eligibility criteria and whether a given wearer of the Hat is in good standing
- `toggle` \- the address that controls whether the Hat is active
- `mutable` \- whether the hat's properties can be changed by the admin
- `imageURI` \- the URI for the image used in the Hat's ERC1155-similar token. Should not exceed 7,000 characters.

For more information on each property, refer to the detailed sections below.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Wearing a Hat

[Permalink: Wearing a Hat](https://github.com/Hats-Protocol/hats-protocol#wearing-a-hat)

The wearer of a given Hat is assigned the authorities and responsibilities associated with the Hat.

A wearer's status relating to a given Hat is determined by three factors. All three must be true.

1. Whether their address has a balance (of 1) of the Hat's token
2. Whether the Hat is active (see the Toggle section for more detail)
3. Whether they are eligible (see the Eligibility section for more detail)

All of these factors are reflected in the `Hats.balanceOf` function, which will return `0` if any of the factors are false.

Any address can wear a Hat, including:

- Externally Owned Accounts (EOAs)
- Logic contracts (i.e., contracts with explicit logic codified within functions), or
- Governance contracts (e.g., DAOs, multisigs, etc.)

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Hat Admins

[Permalink: Hat Admins](https://github.com/Hats-Protocol/hats-protocol#hat-admins)

The admin of every Hat is another Hat. This means that the authority to perform admin functions for a given Hat is assigned to the wearer of its admin Hat.

The scope of authority for a Hat's admin is to determine who can wear it. This is reflected in the ability to create the Hat and to mint or (for mutable Hats) transfer the Hat's token.

#### Hatter Contracts

[Permalink: Hatter Contracts](https://github.com/Hats-Protocol/hats-protocol#hatter-contracts)

Logic contracts that serve as admins are informally known as "hatter" contracts. These are contracts that implement specific logic or rules. The admin of a hatter contract is the true admin, but has delegated said admin authority to the logic embedded in the hatter.

Hatter contract logic is a wide design space for DAOs. Here are some examples of hatter logic:

- **Wearer eligibility** \- Enforce certain requirements that prospective wearers must meet in order to wear a given Hat, such as membership in a DAO or holding some token(s).
- **Wearer staking** \- One particularly important type of eligibility requirement is staking tokens, DAO shares, or some other asset as a bond that could be slashed if the wearer is not a good steward of the accountabilities associated with the Hat, or does not follow through on its associated responsibilities.
- **Hat creation** \- Allow certain addresses -- such as members of a DAO -- to create Hats that are then admin'd by the DAO.
- **Hat minting** \- Allow certain addresses -- such as members of a DAO -- to mint Hat tokens. Together with the above, a DAO could in this way enable its members to create and wear a certain type of Hat permissionlessly. This would be especially if using Hats to facilitate role clarity and legibility.

#### Hat Trees

[Permalink: Hat Trees](https://github.com/Hats-Protocol/hats-protocol#hat-trees)

The ability of a Hat to be an admin of other Hats creates the possibility for a "tree" of Hats, a structure of Hats serving as admins of other Hats. This is useful because it enables a DAO to snip off, but not destroy, a rogue branch by revoking the offending Hat. It could then re-assign that admin Hat to another wearer.

Within a given branch of a hat tree, Hats closer to the root of the tree have admin authorities for Hats further down the branch. This is consistent with the direction of delegation of authority for DAOs, and combats the tendency for accountability to dilute as delegated authorities reach the edges of a network.

#### Tophats

[Permalink: Tophats](https://github.com/Hats-Protocol/hats-protocol#tophats)

Tophats are the one exception to the rule that a Hat's admin must be another hat. A Tophat is a Hat that serves as its own admin.

The root of a Hat tree is always a Tophat. Typically, a DAO will wear the Tophat that serves as admin for the tree of Hats related to the DAO's operations.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Addressable Hat Ids

[Permalink: Addressable Hat Ids](https://github.com/Hats-Protocol/hats-protocol#addressable-hat-ids)

Hat ids are uint256 bitmaps that create an "address" — more like an web or IP address than an Ethereum address — that includes information about the entire branch of admins for a given hat.

The 32 bytes of a hat's id are structured as follows:

- The first 4 bytes are reserved for the top hat id. Since top hat ids are unique across a given deployment of Hats Protocol, we can also think of them as the top level "domain" for a hat tree.
- Each of the next chunks of 16 bits refers to a single "Hat Level".

This means there are 15 total hat levels, beginning with the top hat at level 0 and going up to level 14. A hat at level 6 will have 6 admins in its branch of the tree, and therefore its id will have non-zero values at levels 0-5 as well as its own level. Since these values correspond to its admins, all that is needed to know which hats have admin authorities over a given hat is to know that given hat's id.

#### Hat Tree Space

[Permalink: Hat Tree Space](https://github.com/Hats-Protocol/hats-protocol#hat-tree-space)

A hat tree can have up to 14 levels, plus the top hat (tree root). Within those 14 levels are 224 bits of address space (remember, one level contains 16 bits of space), so the maximum number of hats in a single hat tree is 2224+1≈2.696∗1067, or well beyond the number of stars in the universe.

#### Displaying Hat Ids

[Permalink: Displaying Hat Ids](https://github.com/Hats-Protocol/hats-protocol#displaying-hat-ids)

It is recommended for front ends to instead convert hat ids to hexadecimal, revealing the values of the bytes — and therefore the hat levels — directly.

For example, instead of a hat id looking like this under base 10: `26960769438260605603848134863118277618512635038780455604427388092416`

...under hexadecimal it would look like this: `0x0000000100020003000000000000000000000000000000000000000000000000`

In this second version, you can see that this hat is...

- a level 2 hat
- is in the first hat tree (top hat id = 1)
- is the third hat created at level 2 within this tree
- admin'd by the second hat created at level 1 within this tree

We can also prettify this even further by separating hat levels with periods, a la IP addresses:

`0x00000001.0002.0003.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000.0000`

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Eligibility

[Permalink: Eligibility](https://github.com/Hats-Protocol/hats-protocol#eligibility)

Eligibility modules have authority to rule on the a) eligibility and b) good standing of wearer(s) of a given Hat.

**Wearer Eligibility** (A) determines whether a given address is eligible to wear the Hat. This applies both before and while the address wears the Hat. Consider the following scenarios for a given address:

|  | Eligible | Not Eligible |
| --- | --- | --- |
| **Doesn't wear the Hat** | Hat can be minted to the address | Hat cannot be minted to the address |
| **Currently wears the Hat** | Keeps wearing the Hat | The Hat is revoked |

When a Hat is revoked, its token is burned.

**Wearer Standing** (B) determines whether a given address is in good or bad standing. Standing is stored on-chain in `Hats.sol` to facilitate accountability.

For example, a hatter contract implementing staking logic could slash a wearer's stake if they are placed in bad standing by the eligibility module.

An address placed in bad standing by a Hat's eligibility module automatically loses eligibility for that Hat. Note, though, that ineligibility does necessarily imply bad standing; it is possible for an address may be ineligible but in good standing.

Any address can serve as an eligibility module for a given Hat. Hats Protocol supports two categories of eligibility modules:

1. **Mechanistic eligibility** are logic contracts that implement the `IHatsEligibility` interface, which enables the Hats contract to _pull_ wearer standing by calling `checkWearerStanding` from within the `Hats.balanceOf` function. Mechanistic eligibility enables instantaneous revocation based on pre-defined triggers.
2. **Humanistic eligibility** are either EOAs or governance contracts. To revoke a Hat, humanistic eligibility must _push_ updates to the Hats contract by calling `Hats.ruleOHatWearerStanding`.

Unlike admins, eligibility modules are explicitly set as addresses, not Hats. This is to avoid long, potentially illegible, chains of revocation authority that can affect wearer penalties (such as slashed stake).

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Toggle

[Permalink: Toggle](https://github.com/Hats-Protocol/hats-protocol#toggle)

Toggle contracts have authority to switch the `hat.active` status of a Hat, such as from `active` to `inactive`. When a Hat is inactive, it does not have any wearers (i.e., the balance of its previous wearers' is changed to 0).

Any address can serve as a Hat's toggle. As with eligibility modules, Hats Protocol supports two categories of toggle modules:

1. **Mechanistic toggles** are logic contracts that implement the `IHatsToggle` interface, which enables the Hats contract to _pull_ a Hat's active status by calling `checkToggle` from within the `Hats.balanceOf` function. Mechanistic toggle enable instantaneous deactivation (or reactivation) based on pre-defined logic, such as timestamps ("this Hat expires at the end of the year").
2. **Humanistic toggles** are either EOAs or governance contracts. To deactivate (or reactivate) a Hat, humanistic toggles must _push_ updates to the Hats contract by calling `Hats.toggleHatStatus`.

Unlike admins, toggle modules are explicitly set as addresses, not Hats.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Hat Mutability

[Permalink: Hat Mutability](https://github.com/Hats-Protocol/hats-protocol#hat-mutability)

In some cases, a Hat's properties should be immutable to give everybody (particularly the wearer(s)) maximal confidence in what they are signing up for. But this certainty comes at the expense of flexibility, which is often valuable for DAOs as they evolve and learn more about what their various roles are all about. With this trade-off in mind, Hats can be created as either mutable or immutable.

An **immutable** Hat cannot be changed at all once it has been created. A **mutable** Hat can be changed after it has been created. Only its admin(s) can make the change.

Changes are allowed to the following Hat properties:

- `details`
- `maxSupply` \- as long as the new maxSupply is not less than the current supply
- `eligibility`
- `toggle`
- `mutable` \- this is a one-way change
- `imageURI`

Additionally, mutable hats can be transferred by their admins to a different wearer. Immutable hats cannot be transferred.

#### TopHat Exception

[Permalink: TopHat Exception](https://github.com/Hats-Protocol/hats-protocol#tophat-exception)

The only exception to the above mutability rules is for tophats, which despite being immutable are allowed to change their own `details` and `imageURI` (but not other properties).

Note that this only includes non-linked tophats; a tophat that has been linked (aka grafted) onto another hat tree is no longer considered a tophat, and therefore is subject to the same mutability rules as other hats.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Hat Image URIs

[Permalink: Hat Image URIs](https://github.com/Hats-Protocol/hats-protocol#hat-image-uris)

Like any other NFT, Hats have images. The image for a given Hat is determined by the following logic:

1. If the Hat's `imageURI` property is set, use that
2. If the Hat's `imageURI` property is _not_ set, then use the `imageURI` of the Hat's admin Hat
3. If the admin Hat's `imageURI` property is _not_ set, then use the `imageURI` of _that_ Hat's admin
4. Repeat (3) until you find an `imageURI` that is set
5. If no set `imageURI` is found within the original Hat's hat tree (including the Tophat), then use the `globalImageURI` set in the Hats Protocol contract

This logic creates flexibility for DAOs to efficiently customize images for their Hats, while keeping images as optional.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Creating a Hat

[Permalink: Creating a Hat](https://github.com/Hats-Protocol/hats-protocol#creating-a-hat)

The creator of a Hat must be its admin. In other words, the admin of a Hat must be the `msg.sender` of the `Hats.createHat` function call. Though remember, by delegating its authority to a hatter contract, an admin can enable eligible others to create Hats based on whatever logic it desires.

Creating a Tophat (a Hat that serves as its own admin) requires a special function `mintTophat`, which creates a new Hat, sets that Hat as its own admin, and then mints its token to a `_target`. Any address wanting to create a Hat that is not already wearing an admin Hat of some kind must first create a Tophat with itself as the wearer.

#### Batch Creation

[Permalink: Batch Creation](https://github.com/Hats-Protocol/hats-protocol#batch-creation)

In some scenarios, a DAO may want to create many Hats at once -- including an entire hat tree -- at once. This is particularly useful when setting up an initial structure for a DAO or working group (e.g., from a Hats template) or when forking an existing Hats structure from a template.

Enabling this latter forking/exit scenario is an important protection for Hat wearers against potential abuse of power by their DAO.

To create a batch of Hats, a DAO can call the `Hats.batchCreateHats()` function. This function takes arrays as its arguments, from which it constructs multiple Hats. As long as each of these Hats is part of the same tree of Hats — i.e., they either have the same existing Hat or any of the newly created Hats as admin(s) — they can all be created together.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Minting a Hat

[Permalink: Minting a Hat](https://github.com/Hats-Protocol/hats-protocol#minting-a-hat)

Only a Hat's admin can mint its token to a wearer.

To mint a Hat, the Hat must be active, its max supply must not have already been reached, the target wearer must not already wear the Hat, and the target wearer must be eligible for the Hat.

A Hat's admin can mint its token individually by calling `Hats.mintHat`.

#### Batch Minting

[Permalink: Batch Minting](https://github.com/Hats-Protocol/hats-protocol#batch-minting)

An admin can also mint multiple Hats by calling `Hats.batchMintHats`. This enables an admin to mint instances of the same hat to multiple wearers, to mint several Hats at once, or even to mint an entire Hats tree it just created.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Transferring a Hat

[Permalink: Transferring a Hat](https://github.com/Hats-Protocol/hats-protocol#transferring-a-hat)

Only a Hat's admin can transfer its token(s) to new wearer(s).

Unlike typical tokens, the wearer of a Hat cannot transfer the Hat to another wallet. This is because the authorities and responsibilities associated with a Hat are delegated to, not owned by, the wearer.

As a result, there is no need for safe transfers (transfers which check whether the recipient supports ERC1155) or to pass data to recipient `on1155Received` or `onERC1155BatchReceived` hooks.

For these reasons, in Hats Protocol, the standard ERC1155 transfer functions — `safeTransferFrom` and `safeBatchTransferFrom` are disabled and will always revert. Similarly, token approvals are not required and `setApprovalForAll` will always revert.

As a replacement, Hats can be transferred by admins via `Hats.transferHat`, which emits the ERC1155 standard event `TransferSingle`. Transfer recipients must not already be wearing the hat, and must be eligible to wear the hat.

With the exception of tophats — which can always transfer themselves — only mutable Hats can be transferred. Inactive Hats cannot be transferred.

### Hat Tree Grafting

[Permalink: Hat Tree Grafting](https://github.com/Hats-Protocol/hats-protocol#hat-tree-grafting)

Not all Hats trees will unfurl from top down or inside out. Sometimes, new branches will form independently from the main tree, or multiple trees will form before a main tree even exists.

In these cases, Hat trees can be grafted onto other trees. This is done via a request-approve process where the wearer of one tree's topHat requests to link their topHat to a hat in another tree, whose admin can approve if desired. This has three main effects:

1. The linked tophat loses its topHat status (i.e., `Hats.isTopHat` will return `false`) and turns into what we call a "tree root" or "linked topHat", and
2. The hat to which it is linked becomes its new admin; it is no longer its own admin
3. On linking, the linked topHat can be assigned eligibility and/or toggle modules like any other hat

Linked Hat trees can also be unlinked by the tree root from its linked admin, via `Hats.unlinkTopHatFromTree`. This causes the tree root to regain its status as a top hat and to once again become its own admin. Any eligibility or toggle modules added on linking are cleared. Note that unlinking is only allowed if the tree root is active and has an eligible wearer.

⚠️ **CAUTION**: Be careful when nesting multiple Hat trees. If the nested linkages become too long, the higher level admins may lose control of the lowest level Hats because admin actions at that distance may cost-prohibitive or even exceed the gas limit. Best practice is to not attach external authorities (e.g. via token gating) to Hats in trees that are more than ~10 nested trees deep (varies by network).

#### Relinking

[Permalink: Relinking](https://github.com/Hats-Protocol/hats-protocol#relinking)

Linked topHats can be relinked to a different Hat within the same tree. This is useful for DAOs that want to reorganize their subtrees without having to go through the request and approve steps. Valid relinks must meet the following criteria in order to ensure security:

1. The Hat wearer executing the relink is an admin of both the linked topHat and the new admin (destination)
2. The new admin (destination) is within the same local tree as the existing admin (origin), or within the tippy top hat's local tree. Tippy top hats executing a relink are not subject to these restrictions.
3. The new link does not create a circular linkage.

### Renouncing a Hat

[Permalink: Renouncing a Hat](https://github.com/Hats-Protocol/hats-protocol#renouncing-a-hat)

The wearer of a Hat can "take off" their Hat via `Hats.renounceHat`. This burns the token and revokes any associated authorities and responsibilities from the now-former wearer, but does not put the wearer in bad standing.

( [back to contents](https://github.com/Hats-Protocol/hats-protocol#table-of-contents))

### Multicall

[Permalink: Multicall](https://github.com/Hats-Protocol/hats-protocol#multicall)

This contract inherits from [Multicallable](https://github.com/Vectorized/solady/blob/main/src/utils/Multicallable.sol), which adds a non-payable `multicall` function to the contract. This enables EOAs to make multiple calls to the contract atomically, unlocking a number of useful batch operations that were previously only available to smart contracts.

## License

[Permalink: License](https://github.com/Hats-Protocol/hats-protocol#license)

Distributed under the AGPLv3 License. See `LICENSE.txt` for more information.

( [back to top](https://github.com/Hats-Protocol/hats-protocol#readme-top))

## Contact

[Permalink: Contact](https://github.com/Hats-Protocol/hats-protocol#contact)

Spencer Graham - [@spengrah](https://twitter.com/spengrah)

nintynick - [@nintynick\_](https://twitter.com/nintynick_)

David Ehrlichman - [@davehrlichman](https://twitter.com/davehrlichman)

Project Website: [https://hatsprotocol.xyz/](https://hatsprotocol.xyz/)

Project Link: [https://github.com/Hats-Protocol/hats-protocol/](https://github.com/Hats-Protocol/hats-protocol/)

( [back to top](https://github.com/Hats-Protocol/hats-protocol#readme-top))

## About

Core contracts for Hats Protocol v1


[www.hatsprotocol.xyz](https://www.hatsprotocol.xyz/ "https://www.hatsprotocol.xyz")

### Topics

[open-source](https://github.com/topics/open-source "Topic: open-source") [roles](https://github.com/topics/roles "Topic: roles") [solidity](https://github.com/topics/solidity "Topic: solidity") [web3](https://github.com/topics/web3 "Topic: web3") [evm](https://github.com/topics/evm "Topic: evm") [daos](https://github.com/topics/daos "Topic: daos") [erc1155](https://github.com/topics/erc1155 "Topic: erc1155")

### Resources

[Readme](https://github.com/Hats-Protocol/hats-protocol#readme-ov-file)

### License

[AGPL-3.0 license](https://github.com/Hats-Protocol/hats-protocol#AGPL-3.0-1-ov-file)

### Contributing

[Contributing](https://github.com/Hats-Protocol/hats-protocol#contributing-ov-file)

[Activity](https://github.com/Hats-Protocol/hats-protocol/activity)

[Custom properties](https://github.com/Hats-Protocol/hats-protocol/custom-properties)

### Stars

[**92**\\
stars](https://github.com/Hats-Protocol/hats-protocol/stargazers)

### Watchers

[**4**\\
watching](https://github.com/Hats-Protocol/hats-protocol/watchers)

### Forks

[**27**\\
forks](https://github.com/Hats-Protocol/hats-protocol/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FHats-Protocol%2Fhats-protocol&report=Hats-Protocol+%28user%29)

## [Releases\  5](https://github.com/Hats-Protocol/hats-protocol/releases)

[Hats Protocol v1\\
Latest\\
\\
Jul 11, 2023](https://github.com/Hats-Protocol/hats-protocol/releases/tag/v1)

[\+ 4 releases](https://github.com/Hats-Protocol/hats-protocol/releases)

## [Contributors\  5](https://github.com/Hats-Protocol/hats-protocol/graphs/contributors)

- [![@spengrah](https://avatars.githubusercontent.com/u/13247381?s=64&v=4)](https://github.com/spengrah)
- [![@nintynick](https://avatars.githubusercontent.com/u/10171948?s=64&v=4)](https://github.com/nintynick)
- [![@topocount](https://avatars.githubusercontent.com/u/17910833?s=64&v=4)](https://github.com/topocount)
- [![@davehrlichman](https://avatars.githubusercontent.com/u/110009869?s=64&v=4)](https://github.com/davehrlichman)
- [![@omahs](https://avatars.githubusercontent.com/u/73983677?s=64&v=4)](https://github.com/omahs)

## Languages

- [Solidity100.0%](https://github.com/Hats-Protocol/hats-protocol/search?l=solidity)
